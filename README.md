# IntelligentCarRace
This is a repository for 2018 NXP Cup National Intelligent Car Racing Contest (Wireless Group) HKUST Robotis Team
This repository has been revised after the competition as a reflect on the car structure and algorithm designs.
<p align="center">
  <img height="260" src="https://github.com/jrenaf/IntelligentCarRace/blob/master/png/sideview.jpg">
  <img height="260" src="https://github.com/jrenaf/IntelligentCarRace/blob/master/png/topview.jpg">
</p>
## Objective and Methodology:
Since my division was to build a car that saved energy while ran fast, after thorough consideration, we decided neither adopt nor revise any car model available but to build a new one adaptive to our target on our own. The car models offered by the committee focused much more on the stability rather than the light weight, so it might result in consuming more energy, which would cause a delay in the battery charging stage and a longer time in term of counting final score. Roughly, we used SOLIDWORKS to calculate the dimension, draw the configuration of parts and design the structure of the assembly. During this stage, we managed to minimize the dimension as well as the weight but not sacrifice too much structural strength so long as it could satisfy various road conditions. Meanwhile, the model also needed to provide enough space for hardware boards which were also considered and utilized as parts of structure to support the model. The motor was main consumer of energy in the whole car, so we decreased the quantity of motor from two driving each rear wheel and realizing the algorithm-controlling differential to one driving both the rear wheels while combining another servo motor to steer the front wheel. The mechanical differential provided by Lego is included in this design. We also applied the wheel with less contact surface with track to reduce the wastage of energy generated by friction.

For the software and algorithm part, the car was requested to follow the guidance of the magnetic line buried along the midline of the track to finish various road conditions like straight way, curve, cross road, loop etc. We considered to acquire a pair of value given by magnetics sensors at the front left end and front right end and substitute them into the PID-tuning algorithm to steer the front wheel. Another pair of sensors at the rear left end and rear right end assisted the front pair to finish loop track. Regarding the loop track, which was the most challenging one among all road conditions, we divided the task into four stages: detecting, entering, orbiting and escaping. Detecting stage: Since the loop is tangent with straight track, the magnetic line intersected at the point of tangency, hence the value detected by the sensors at this point was much higher than that of other track regions. Once the combination of all four sensors’ value overpassed the threshold, the algorithm was activated into the loop mode; Entering stage: the revised algorithm was initiated and now the car was steered to go either the left side or the right side of track depends on the which side of track the loop was in. The car now separated from main track and went into loop track; Orbiting stage: afterwards, we gradually directed the car back to on the midline of loop track by narrowing down the discretion of left and right value in the algorithm. The car then orbited in the same algorithm of straight track; Escaping stage: when the car reached the tangent point again, we used the hard code to direct the car going the straight line for a short moment and then returned to straight way algorithm to separate from loop track.

## Rresult:
We ran tension test in SOLIDWORKS on some parts and based on the result we filleted some corners and bends or increased the thickness to improve structural strength. When we were testing the real car model on the curving track in high speed, we found the center of gravity would slide to one side enormously because of the centrifugal force and car body might tilt and scratch the ground. To solve this problem, we replaced the single-front-wheel to dual-front wheel mechanism to improve stability and performance. And we also altered the height of coil to both lower the center of gravity and better receive the electricity generated the wireless charger beneath the car. 
Loop test need much more trails and modification. We shifted a lot of location of sensors to compare which version adapted to the algorithm much better. Also, we found our initial methodology can only fit in loops with same radius, however, we could not foresee loop with what perimeter we would meet in contest. We introduced a new variable into ordinary PID tuning function to deviate the car from straight track through the magnetic detection instead of a hardcode of angle and time, which would result in a sharp, unstable and speculative loop-entering as well as less adaptiveness to loop size. The introduction of this new variable was proved to make the whole entering process smooth and reliable.
In case that magnetic field’s intensity of contest track might vary from that of our testing track, every time before the departure, we added a “standard intensity” as reference based on the real-time feedback from the contest field to make car resilient to different kind of track.

## Summary, Improvement and Further Development:
I believe our car model design is novel and practical. In the car exhibition after the contest, we found our car is only one designed from scratch and over 90 percent of body draw in SOLIDWORKS and built in 3D printing material. However, in capacitors bank charging stage, we lacked enough experiment which led to last failure. I should attend more to the hardware job in charge of by my teammate and cover the shortage as early as possible
Besides, there are still some deficiencies and space for improvement in other fields. We used our team own-designed smart car PID-tuning application called SMARTCARPROCESSING to tune the car, which reflects the data and image direct and clear. This application is adaptable to other divisions as well with little transformation. However, this application is still at initial developing stage owing to the limited time. With future improvement, I think it could offer lots of help to Smart Car team in following years by making PID-tuning process easier and convenient.
For the further development, wireless groups’ topics this year are quick wireless charging and energy conservation. Our model is a good exhibition of applying wireless charging technology on electric automobiles. Just like wireless charging on phone becomes much more common and prevailing today, it will soon be applied on other portable battery-powered devices. The future progress in wireless charging techniques and development of commercial products will provide a promising alternative way to address the energy bottleneck of conventionally portable battery-powered devices. 

## Maintainers:
Jiming REN (jrenaf@connect.ust.hk)

